template:
    name: 
        {
            pt: 'Upload de arquivos com webshell',
            en: 'File upload webshell'
        }
    type: Web
    category: 'Abuse of Functionality'
    subcategory: 'Unsafe File Upload'
    description: 
        { 
            pt: 'As vulnerabilidades de upload de arquivos ocorrem quando a aplicação permite que os usuários façam upload de arquivos para seu sistema de arquivos sem validar suficientemente coisas como nome, tipo, conteúdo ou tamanho. Deixar de aplicar corretamente as restrições sobre isso pode significar que até mesmo uma função básica de upload de imagem pode ser usada para fazer upload de arquivos arbitrários e potencialmente perigosos. Isso pode até incluir arquivos de script do lado do servidor que permitem a execução remota de código.', 
            en: 'File upload vulnerabilities occur when the application allows users to upload files to its file system without sufficiently validating things like name, type, content, or size. Failing to properly enforce restrictions on this can mean that even a basic image upload function can be used to upload arbitrary and potentially dangerous files. This can even include server-side script files that allow remote code execution.' 
        }
    recomendation: 
        { 
            pt: 'Restringir os tipos de arquivos aceitos para upload, verifique a extensão do arquivo e apenas permita que certos arquivos sejam carregados. Use uma abordagem de "whitelist" em vez de uma "blacklist". Verifique se há extensões duplas, como .php.png. Verifique se há arquivos sem um nome de arquivo como .htaccess (em ASP.NET, verifique se há arquivos de configuração como web.config). Altere as permissões na pasta de upload para que os arquivos dentro dele não sejam executáveis. Se possível, renomeie os arquivos que são carregados.', 
            en: 'Restrict file types accepted for upload, check file extension and only allow certain files to be uploaded. Use a "whitelist" approach rather than a "blacklist". Check for dual extensions such as .php.png. Check for files without a filename like .htaccess (in ASP.NET, check for configuration files like web.config). Change the permissions on the upload folder so that the files inside it are not executable. If possible, rename the files that are uploaded.' 
        }
    references: ['https://cheatsheetseries.owasp.org/cheatsheets/File_Upload_Cheat_Sheet.html']
